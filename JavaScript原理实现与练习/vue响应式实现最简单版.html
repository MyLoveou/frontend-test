<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
  <script>
    // // 对原始值进行响应式
    // let price = 10, quantity = 2, total = 0
    // const dep = new Set()
    // const effect = () => { total = price * quantity }
    // const track = () => { dep.add(effect) } // 收集副作用
    // const trigger = () => { dep.forEach(effect => effect()) } // 执行副作用，也就是回调函数

    // track()
    // console.log(`total: ${total}`)
    // trigger()
    // console.log(`total:${total}`)
    // price = 20
    // trigger()
    // console.log(`total: ${total}`)

    // // 对单个对象进行响应式
    // let product = { price: 10, quantity: 2 }, total2 = 0
    // const depsMap = new Map()
    // const effect2 = () => { total = product.price * product.quantity }
    // const track2 = key => {
    //   let dep = depsMap.get(key)
    //   if (!dep) {
    //     depsMap.set(key, (dep = new Set()))
    //   }
    //   dep.add(effect2)
    // }

    // const trigger2 = key => {
    //   let dep = depsMap.get(key)
    //   if (dep) {
    //     dep.forEach(effect => effect())
    //   }
    // }

  </script>
</body>

</html>